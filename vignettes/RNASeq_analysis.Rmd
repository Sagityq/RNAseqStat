---
title: "RNASeq_analysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{enrichment_analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Basic Default Worflow

```{r setup}
library(RNAseqStat)
results_dir = "test"
```

### Check your data

This step is useful to quickly check you data. dir Can be any wherr you want to save results file.

```{r eval=FALSE}
pre_check(counts_data = counts_input, group_list = group_list, dir = results_dir)
```

### DEG analysis

DEG analysis will be run by limma edgeR and DESeq2 in this step.

```{r eval=FALSE}
deg_run(counts_input,group_list,test_group = "T", control_group = "C",dir = results_dir)
```

### GO

Enrichment analysis of GO will be done in this Step.

```{r eval=FALSE}
enrichGO_run(DEG_df, x = "log2FoldChange", y = "pvalue", dir = results_dir)
```

### KEGG

Enrichment analysis of KEGG will be done in this Step.

```{r eval=FALSE}
enrichKEGG_run(DEG_df, x = "log2FoldChange", y = "pvalue", dir = results_dir)
```

### GSEA

```{r}
enrichgesKEGG_run(DEG_df, x = "log2FoldChange", dir = results_dir)
```


### More

Firstly load results data from DEG analysis in step 2. For example, a DEG data frame produced by DEGSeq2 and group_list

```{r loadData}
head(DEG_df)[1:10,]
table(group_list)
```

Up and Down gene should be grouped ahead of Enrichment analysis. A handly function proved in our package

```{r groupData}
DEG_df_g <- cut_much(DEG_df,x = "log2FoldChange",y = "pvalue",cut_FC = 2,cut_P = 0.01)
```
